

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Service API &mdash; ASM 40u documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="ASM 40u documentation" href="index.html"/>
        <link rel="next" title="Publishing" href="publishing.html"/>
        <link rel="prev" title="Mobile Interface" href="mobile.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ASM
          

          
          </a>

          
            
            
              <div class="version">
                40u
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="foreword.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="searching.html">Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="animals.html">Animals</a></li>
<li class="toctree-l1"><a class="reference internal" href="people.html">People</a></li>
<li class="toctree-l1"><a class="reference internal" href="movements.html">Movements</a></li>
<li class="toctree-l1"><a class="reference internal" href="documents.html">Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="animalcontrol.html">Animal Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="lostandfound.html">Lost and Found</a></li>
<li class="toctree-l1"><a class="reference internal" href="waitinglist.html">Waiting List</a></li>
<li class="toctree-l1"><a class="reference internal" href="generaldiary.html">General Diary</a></li>
<li class="toctree-l1"><a class="reference internal" href="accounts.html">Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="stockcontrol.html">Stock Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="reports.html">Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="litters.html">Litters</a></li>
<li class="toctree-l1"><a class="reference internal" href="onlineform.html">Online Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="rota.html">Rota</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobile.html">Mobile Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Service API</a></li>
<li class="toctree-l1"><a class="reference internal" href="publishing.html">Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mailmerge.html">Mail Merge Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="options.html">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="wordkeys.html">Appendix: Wordkeys</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Appendix: Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="databasetables.html">Appendix: Database Tables/Columns</a></li>
<li class="toctree-l1"><a class="reference internal" href="relationships.html">Appendix: Entity Relationship Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="csvimportfields.html">Appendix: CSV file import fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="onlineformfields.html">Appendix: Online Form import fields</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ASM</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Service API</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/service.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="service-api">
<h1>Service API<a class="headerlink" href="#service-api" title="Permalink to this headline">Â¶</a></h1>
<p>ASM includes a service API that you can call from other software via HTTP. To
call the API you construct a URL to the service controller. The service
controller is /service, so if you are accessing a local ASM from your local
machine, the URL will start <a class="reference external" href="http://localhost:5000/service">http://localhost:5000/service</a>. If you are using
sheltermanager.com, the URL will start <a class="reference external" href="https://sheltermanager.com/asm/service">https://sheltermanager.com/asm/service</a>.</p>
<p>If you are using sheltermanager.com, please be aware that service call
responses are cached for performance. All requests for shelter/adoptable animal
data will be cached for the next hour, with requests for online forms cached
for the next couple of minutes.</p>
<p>While the examples here show passing the parameters with HTTP GET requests, you
can POST the parameters too if you prefer.</p>
<p>The service requires the following parameters:</p>
<ul class="simple">
<li>account: If this is a sheltermanager.com service call, the user&#8217;s account
number. Can be omitted for other installations.</li>
<li>username: A valid ASM user.</li>
<li>password: A valid ASM password. From a security standpoint, it&#8217;s better to
create at least one ASM user dedicated to calling the service to assist with
audit trails and to lock it down so an attacker with the URL cannot change
your data or view anything you don&#8217;t want them to.</li>
<li>method: A service method to call</li>
<li>animalid / title: An animal ID or title depending on the service method
called.</li>
</ul>
<p>The following method values are supported:</p>
<p><strong>animal_image</strong></p>
<p>Returns an animal&#8217;s preferred image. Send the id of the animal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:5000/service?method=animal_image&amp;animalid=520&amp;seq=1
</pre></div>
</div>
<p>An optional &#8220;seq&#8221; parameter can be included to return the animal&#8217;s other
available images. seq=1 returns the preferred image (and will be assumed if
that parameter is omitted), seq=2 returns the second available image, etc. seq
is a 1-based count and can be used with the &#8220;WebsiteImageCount&#8221; property
included in animal records (which contains the number of images an animal has)
to programatically grab all the images for a particular animal.</p>
<p><strong>animal_view</strong></p>
<p>Returns a webpage with information for one animal, constructed from the animal_view
HTML publishing template (see <span class="menuselection">Publishing-&gt;Edit HTML publishing
templates</span>). Pass the id of the animal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:5000/service?method=animal_view&amp;animalid=520
</pre></div>
</div>
<p>When you use <span class="menuselection">Share-&gt;Link to this animal</span> on an animal&#8217;s record,
it is this service call that the system redirects you to.</p>
<p><strong>animal_view_adoptable_js</strong></p>
<p>Returns a javascript file that when executed injects thumbnails of all
adoptable animals into the page with links to the animal_view service call.
The page must contain a div called &#8220;asm3-adoptables&#8221;, where the adoptable
animal thumbnails will appear. If div#asm3-adoptables cannot be found, a popup
error message will appear.</p>
<p>Here&#8217;s an example page showing how to inject your adoptable animal list:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Adoptable Animals&lt;/title&gt;
&lt;body&gt;

&lt;div id=&quot;asm3-adoptables&quot; /&gt;
&lt;script src=&quot;http://localhost:5000/service?method=animal_view_adoptable_js&quot;&gt;&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>The output is unstyled and very basic - just a thumbnail with a name/link below
and two lines of brief text containing some basic information about the animal.
You can style this information by adding CSS to your stylesheets for the
following classes:</p>
<ul class="simple">
<li>asm3-adoptable-item : The div surrounding each item</li>
<li>asm3-adoptable-link : The a tag enclosing the thumbnail and animal name</li>
<li>asm3-adoptable-thumbnail : The thumbnail img tag</li>
<li>asm3-adoptable-name : The animal&#8217;s name</li>
<li>asm3-adoptable-tagline : The brief animal information</li>
<li>asm3-adoptable-age : The animal&#8217;s age</li>
</ul>
<p><strong>extra_image</strong></p>
<p>Returns an extra image (see <span class="menuselection">Settings-&gt;Reports-&gt;Extra Images</span>).
Pass the name of the image in the title parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:5000/service?method=extra_image&amp;title=splash.jpg
</pre></div>
</div>
<p><strong>json_adoptable_animals | xml_adoptable_animals</strong></p>
<p>Returns a dataset containing all animals available for adoption. The method
determines whether the format returned is JSON or XML:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:5000/service?method=xml_adoptable_animals&amp;username=user&amp;password=letmein
</pre></div>
</div>
<p><strong>json_recent_adoptions | xml_recent_adoptions</strong></p>
<p>Returns a dataset containing all recently adopted animals with their new owner
information. The method name determines whether the format returned is JSON or
XML.</p>
<p><strong>html_report</strong></p>
<p>Returns an HTML document containing a report. Pass the name of the report in
the title attribute. If the report requires any parameters, you can pass those
too. VAR parameters are just their name, ASK parameters are ASKn where n is the
order within the SQL. If you run the report within the ASM frontend you will
see the parameters it requires in the address bar:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:5000/service?method=html_report&amp;username=user&amp;password=letmein&amp;title=Detailed+Shelter+Inventory
</pre></div>
</div>
<p><strong>csv_mail</strong> or <strong>csv_report</strong></p>
<p>Returns a CSV file containing a mail merge or report. Pass the name of the mail
merge/report in the title attribute and if the merge requires any parameters,
you can pass those too just like with html_report.</p>
<p><strong>json_shelter_animals | xml_shelter_animals</strong></p>
<p>Returns a dataset containing all shelter animals. The method determines whether
the format returned is JSON or XML.</p>
<p><strong>rss_timeline</strong></p>
<p>Returns an RSS feed of the timeline:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://localhost:5000/service?method=rss_timeline&amp;username=user&amp;password=letmein
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="publishing.html" class="btn btn-neutral float-right" title="Publishing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mobile.html" class="btn btn-neutral" title="Mobile Interface" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Sheltermanager, Ltd.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'40u',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>